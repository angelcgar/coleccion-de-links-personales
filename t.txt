PROMPT: Refactoriza esta página para que toda la lógica de autenticación y permisos se ejecute del lado del servidor.
Contexto:
- Archivo actual: src/app/create-new-link/page.tsx
- Proyecto en Next.js con App Router y TypeScript.
- Actualmente la página usa "use client" y contiene lógica de Clerk (auth, allowedUsers, validaciones) directamente en el cliente.
- Objetivo: mover TODA esa lógica al lado del servidor para que los datos sensibles (como allowedUsers) no se envíen al cliente.
- Usa las APIs de Clerk para el server: auth(), currentUser(), redirectToSignIn() desde "@clerk/nextjs/server".
- Declara la lista allowedUsers como variable de entorno (process.env.ALLOWED_USERS, separada por comas).
- En el servidor, valida que el usuario esté autenticado y que su userId o email esté incluido en allowedUsers.
- Si no está autenticado, usa redirectToSignIn().
- Si no está autorizado, renderiza un componente simple <UnauthorizedMessage /> (ya existe o lo importas de "@/components/unauthorized-message").
- Mantén la UI, los imports y la funcionalidad de la página exactamente igual. Solo mueve las validaciones fuera del cliente.
- Elimina "use client" si ya no es necesaria. Solo mantenla si hay componentes que realmente la requieren (por ejemplo, estados, animaciones o hooks del cliente).
- No cambies estilos, animaciones, ni la lógica de la base de datos con @libsql/client.
- Usa tipado estricto en TypeScript (usa types de Clerk si aplica).
Resultado esperado: una página de servidor (sin "use client") que primero valida al usuario con Clerk en el backend, protege el acceso con allowedUsers desde .env, y mantiene la UI intacta.
